sudo: false
language: rust
rust:
  - stable
cache: cargo
before_script:
  - cd ..
  - git clone https://github.com/JeroenCops/LearningRust.git
  - cargo install mdbook
  - git clone https://github.com/cobalt-org/cobalt.rs.git
  - cd cobalt.rs
  - cargo install --force || true
  - export PATH="$PATH:/home/travis/.cargo/bin"
  - cd ..
  - mdbook --version
  - mdbook build LearningRust
  - cp -r LearningRust/book JeroenCops.github.io/src/build/projects
  - cd JeroenCops.github.io/src
script:
  - cobalt --version
  - cobalt build
after_success: |
  [ $TRAVIS_BRANCH = source ] &&
  [ $TRAVIS_PULL_REQUEST = false ] &&
  cobalt import --branch master &&
  git config user.name "Travis CI Worker" &&
  git config user.email "jernncops@live.be" &&
  git push -fq https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git master
